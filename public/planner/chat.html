<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Event Chat</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <link rel="stylesheet" href="planner.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: var(--planner-porcelain, #f8f9f8);
      --panel: #fff;
      --border: var(--planner-border, #dcd6c7);
      --text: var(--planner-ink, #50695b);
      --muted: #70877b;
      --accent: var(--planner-green, #50695b);
      --bubble: var(--planner-ink, #50695b);
      --shadow: 0 14px 32px rgba(62, 83, 73, 0.16);
    }
    html, body { height:100%; }
    body { background: var(--bg); min-height:100vh; display:flex; }
    .planner-shell { display:flex; min-height:100vh; width:100%; }
    .content-area { display:flex; flex-direction:column; flex:1; min-height:0; }
    .page.chat-page { padding: 0; flex:1; display:flex; min-height:0; }
    .chat-surface { padding: 20px; font-family: "DM Sans","Segoe UI",sans-serif; color: var(--text); flex:1; display:flex; min-height:0; }
    .app-shell { display:flex; flex-direction:column; background:var(--panel); border-radius:18px; box-shadow:var(--shadow); flex:1; min-height:0; overflow:hidden; }
    .app-bar { display:flex; justify-content:space-between; align-items:center; padding:14px 18px; border-bottom:1px solid var(--border); background:linear-gradient(120deg,#fff 0%,#f8fafc 100%); }
    .app-bar__left { display:flex; align-items:center; gap:12px; min-width:0; }
    .title-stack .title { font-weight:700; font-size:18px; letter-spacing:-0.01em; }
    .title-stack .subtitle { color:var(--muted); font-size:13px; }
    .presence-dot { width:8px; height:8px; border-radius:50%; background:#22c55e; margin-left:6px; box-shadow:0 0 0 5px rgba(34,197,94,0.14); display:inline-block; }
    .app-bar__right { display:flex; align-items:center; gap:10px; }
    .role-toggle { display:inline-flex; align-items:center; gap:6px; background:#f1f5f9; padding:6px; border-radius:999px; border:1px solid var(--border); }
    .role-toggle span { color:var(--muted); font-size:12px; padding:0 6px 0 10px; white-space:nowrap; }
    .role-toggle button { border:none; background:transparent; padding:8px 12px; border-radius:999px; font-weight:700; color:var(--muted); cursor:pointer; }
    .role-toggle button.active { background:var(--panel); color:var(--text); box-shadow:0 6px 20px rgba(15,23,42,0.12); }
    .icon-button { border:1px solid var(--border); background:var(--panel); border-radius:12px; width:36px; height:36px; display:inline-flex; align-items:center; justify-content:center; cursor:pointer; color:var(--text); }
    .icon-button.ghost { border:none; background:transparent; }
    .layout { display:grid; grid-template-columns:1fr 420px; min-height:0; height:100%; }
    .chat-panel { position:relative; border-right:1px solid var(--border); background:linear-gradient(180deg,#fff 0%,#f8fafc 100%); display:flex; flex-direction:column; min-width:0; min-height:0; height:100%; }
    .chat-scroll { flex:1 1 auto; min-height:0; overflow-y:auto; overflow-x:visible; padding:24px 28px 24px 28px; display:flex; flex-direction:column; gap:16px; width:100%; max-width:100%; margin:0; }
    .chat-banner { width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:rgba(193,202,195,0.2); color:var(--text); font-size:13px; box-shadow:0 6px 14px rgba(62,83,73,0.08); margin:0 0 12px 0; display:flex; align-items:center; gap:8px; }
    .chat-banner.live { background:rgba(193,202,195,0.24); border-color:var(--planner-border, #dcd6c7); }
    .chat-banner button { border:1px solid var(--border); background:#fff; padding:4px 10px; border-radius:10px; cursor:pointer; font-weight:600; color:var(--text); }
    .chat-banner button:hover { border-color:var(--accent); color:var(--accent); }
    .message { width:100%; display:flex; flex-direction:column; gap:6px; }
    .message .meta { font-size:12px; color:var(--muted); display:flex; gap:6px; padding-left:4px; }
    .bubble { border-radius:18px; padding:14px 16px; background:var(--panel); border:1px solid var(--border); color:var(--text); box-shadow:0 10px 26px rgba(15,23,42,0.08); line-height:1.45; }
    .message.planner .bubble { background:linear-gradient(140deg,#0f172a,#111827); color:#fff; border:none; }
    .message.client .bubble { background:#fff; }
    .message.system { align-self:center; width:100%; max-width:620px; }
    .message.system .bubble { text-align:center; background:#f1f5f9; border:1px solid #e2e8f0; color:var(--text); }
    .message.action { align-self:center; width:100%; max-width:620px; }
    .message.action .bubble { background:#e8edf5; border:1px solid #d9e2ec; display:flex; flex-direction:column; gap:12px; }
    .action-button { align-self:center; padding:12px 18px; background:var(--bubble); color:#fff; border:none; border-radius:12px; font-weight:700; cursor:pointer; }
    .attachment { margin-top:10px; border-radius:12px; overflow:hidden; border:1px solid var(--border); background:var(--panel); }
    .attachment img { display:block; width:100%; height:auto; }
    .attachment.file-chip { padding:10px 12px; display:inline-flex; gap:8px; font-weight:700; color:var(--text); }
    .composer { border-top:1px solid var(--border); padding:14px 16px; background:linear-gradient(180deg,#fff 0%,#f8fafc 100%); display:flex; gap:8px; flex-wrap:wrap; align-items:center; box-shadow:0 -8px 24px rgba(15,23,42,0.04); position:sticky; bottom:0; width:100%; max-width:100%; margin:0; }
    .composer .field { flex:1 1 auto; min-width:0; display:flex; align-items:center; gap:8px; background:#f8fafc; border-radius:14px; padding:10px 12px; border:1px solid var(--border); }
    .composer input { border:none; background:transparent; width:100%; font-size:14px; color:var(--text); outline:none; }
    .composer input:focus { outline:none; box-shadow:none; }
    .pending-files { display:flex; flex-wrap:wrap; gap:6px; flex:0 0 auto; min-width:0; align-items:center; }
    .pending-files:empty { display:none; }
    .pending-files .file-pill { display:inline-flex; gap:6px; padding:6px 10px; border-radius:12px; background:#e2e8f0; color:var(--text); font-size:12px; font-weight:600; }
    .pending-files .file-pill button { border:none; background:transparent; cursor:pointer; color:var(--muted); padding:0; font-weight:700; }
    .send { background:var(--accent); border:none; color:#fff; padding:10px 16px; border-radius:12px; font-weight:800; cursor:pointer; box-shadow:0 10px 20px rgba(13,123,127,0.25); }
    .details-panel { background:linear-gradient(180deg,#fff 0%,#f8fafc 100%); padding:16px; display:flex; flex-direction:column; gap:16px; height:100%; min-height:0; overflow:hidden; }
    .details-scroll { flex:1; min-height:0; display:flex; flex-direction:column; gap:16px; overflow-y:auto; padding-right:4px; }
    .details-actions { position:sticky; bottom:0; padding-top:8px; margin-top:8px; background:linear-gradient(180deg,rgba(248,250,252,0) 0%,#f8fafc 60%); }
    .panel-header { display:flex; justify-content:space-between; align-items:flex-start; gap:12px; padding:12px 14px; background:#fff; border:1px solid var(--border); border-radius:14px; box-shadow:0 6px 20px rgba(15,23,42,0.08); }
    .panel-header .eyebrow { font-size:12px; letter-spacing:0.08em; text-transform:uppercase; color:var(--muted); margin:0 0 4px 0; }
    .panel-header .muted { margin:0; color:var(--muted); font-size:13px; }
    .status-chip { padding:8px 12px; border-radius:999px; font-weight:700; font-size:12px; background:#fef3c7; color:#92400e; border:1px solid #fcd34d; align-self:flex-start; }
    .status-chip.confirmed { background:#dcfce7; color:#166534; border:1px solid #86efac; }
    .details-form { display:grid; grid-template-columns:1fr; gap:12px; background:#fff; border-radius:14px; padding:14px; border:1px solid var(--border); }
    .field-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    label.field { display:flex; flex-direction:column; gap:6px; font-size:13px; color:var(--muted); }
    label.field input { border:1px solid var(--border); background:#f8fafc; border-radius:12px; padding:10px 12px; font-size:14px; color:var(--text); }
    label.field input:focus { outline:none; border:1px solid var(--accent); box-shadow:0 0 0 3px rgba(13,123,127,0.18); }
    label.field input[disabled] { background:#f1f5f9; color:#94a3b8; cursor:not-allowed; }
    .favorites { background:#fff; border-radius:14px; border:1px solid var(--border); padding:14px; display:flex; flex-direction:column; gap:10px; }
    .favorites-head { display:flex; justify-content:space-between; align-items:center; color:var(--text); font-weight:700; }
    .text-link { border:none; background:transparent; color:var(--accent); font-weight:700; cursor:pointer; }
    .service-card { padding:12px; border-radius:12px; border:1px solid var(--border); background:#f8fafc; display:flex; align-items:center; justify-content:space-between; gap:10px; }
    .service-card .meta { display:flex; flex-direction:column; gap:4px; }
    .service-card .meta .name { font-weight:700; color:var(--text); }
    .service-card .meta .vendor { color:var(--muted); font-size:13px; }
    .pill { padding:6px 10px; border-radius:999px; background:#e2e8f0; font-weight:700; color:var(--text); font-size:12px; }
    .primary { padding:14px; border-radius:14px; border:none; background:var(--bubble); color:#fff; font-weight:800; cursor:pointer; width:100%; }
    .primary:disabled { background:#cbd5e1; cursor:not-allowed; }
    .menu { position:relative; }
    .menu-panel { position:absolute; right:0; top:46px; min-width:190px; background:#fff; border:1px solid var(--border); border-radius:12px; box-shadow:0 14px 32px rgba(15,23,42,0.12); display:none; flex-direction:column; z-index:10; }
    .menu-panel button { border:none; background:transparent; padding:12px 14px; text-align:left; cursor:pointer; font-weight:600; color:var(--text); }
    .menu-panel button:hover { background:#f8fafc; }
    .menu.open .menu-panel { display:flex; }
    @media (max-width:1080px){ .layout{grid-template-columns:1fr;height:100%;min-height:0;} .details-panel{order:-1;height:100%;min-height:0;} .chat-panel{height:100%;min-height:0;} .chat-scroll,.composer{max-width:100%;} }
    @media (max-width:720px){ .role-toggle span{display:none;} .title-stack .title{font-size:16px;} .layout{height:100%;min-height:0;} .chat-panel{height:100%;} .chat-scroll{height:100%;max-height:none;} .composer{max-width:100%;} }
  </style>
</head>
<body data-page="chat">
  <div class="planner-shell">
    <aside class="sidebar">
      <div class="brand"><img class="brand-logo" src="../images/logo.original.png" alt="Event Planner Logo" /></div>
      <nav class="nav">
        <a href="dashboard.html" data-nav="dashboard"><span class="dot"></span>Dashboard</a>
        <a href="assigned-events.html" data-nav="assigned"><span class="dot"></span>Assigned Events</a>
        <a href="chat.html" data-nav="chat"><span class="dot"></span>Chat</a>
        <a href="catalog.html" data-nav="catalog"><span class="dot"></span>Catalog</a>
        <a href="my-items.html" data-nav="my-items"><span class="dot"></span>My Items</a>
        <a href="pending-approval.html" data-nav="pending"><span class="dot"></span>Pending Approval</a>
        <a href="../account.html"><span class="dot"></span>Profile</a>
      </nav>
      <footer>Signed in as planner<br /><small>Chat workspace</small></footer>
    </aside>

    <div class="content-area">
      <div class="topbar">
        <button id="navToggle" class="btn-ghost" style="padding:10px 12px;border-radius:10px;display:none"><i class="fa-solid fa-bars"></i></button>
        <div class="search"><i class="fa-solid fa-magnifying-glass"></i><input id="searchTop" type="search" placeholder="Search your work" /></div>
        <div class="avatar"><img src="../images/logo.png" alt="Planner avatar" /></div>
      </div>

      <main class="page chat-page">
        <div class="chat-surface">
          <div class="app-shell">
            <header class="app-bar">
              <div class="app-bar__left">
                <button class="icon-button ghost" aria-label="Back" onclick="history.back()"><i class="fa-solid fa-chevron-left"></i></button>
                <div class="title-stack">
                  <div class="title">Sarah's Wedding</div>
                  <div class="subtitle">Sarah Chen &bull; Online <span class="presence-dot"></span></div>
                </div>
              </div>
              <div class="app-bar__right">
                <div class="role-toggle" id="roleToggle">
                  <span>Viewing as</span>
                  <button data-role="planner" class="active">Planner</button>
                  <button data-role="client">Client</button>
                </div>
                <button class="icon-button" aria-label="Call"><i class="fa-solid fa-phone"></i></button>
                <button class="icon-button" aria-label="Video"><i class="fa-solid fa-video"></i></button>
                <div class="menu" id="menu">
                  <button class="icon-button" id="menuButton" aria-haspopup="true" aria-expanded="false"><i class="fa-solid fa-ellipsis-vertical"></i></button>
                  <div class="menu-panel" id="menuPanel">
                    <button data-menu="proposal">Generate Proposal</button>
                    <button data-menu="contract">Generate Contract</button>
                    <button data-menu="payment">Send Payment Link</button>
                  </div>
                </div>
              </div>
            </header>

            <main class="layout">
              <section class="chat-panel">
                <div id="chatConnectionBanner" class="chat-banner"></div>
                <div class="chat-scroll" id="messageList"></div>
                <div class="composer">
                  <div class="field">
                    <button class="icon-button" id="attachButton" aria-label="Attach"><i class="fa-solid fa-paperclip"></i></button>
                    <input id="messageInput" type="text" placeholder="Type a message..." />
                  </div>
                  <input id="fileInput" type="file" accept="image/*,.pdf" multiple style="display:none" />
                  <div id="pendingFiles" class="pending-files"></div>
                  <button class="send" id="sendButton">Send</button>
                </div>
              </section>

              <aside class="details-panel">
                <div class="details-scroll">
                  <div class="panel-header">
                    <div><p class="eyebrow">Event Details</p><p class="muted">Edit details as you discuss with the client</p></div>
                    <div class="status-chip pending" id="statusChip">Pending</div>
                  </div>
                  <form id="detailsForm" class="details-form">
                    <label class="field">Event Type <input type="text" data-field="type" /></label>
                    <label class="field">Location <input type="text" data-field="location" /></label>
                    <div class="field-row">
                      <label class="field">Date <input type="date" data-field="date" /></label>
                      <label class="field">Guest Count <input type="number" min="0" step="1" data-field="guestCount" /></label>
                    </div>
                    <label class="field">Budget (USD) <input type="number" min="0" step="500" data-field="budget" /></label>
                  </form>
                  <div class="favorites">
                    <div class="favorites-head">
                      <span>Selected Services</span>
                      <div class="chip-row">
                        <button class="text-link" id="addService">Add</button>
                        <span class="pill" id="rulesChip">Planner can edit</span>
                      </div>
                    </div>
                    <div id="serviceList"></div>
                  </div>
                  <div class="small-actions" style="display:flex;gap:10px;flex-wrap:wrap;">
                    <button id="generateProposal">Generate Proposal</button>
                    <button id="generateContract">Generate Contract</button>
                  </div>
                </div>
                <div class="details-actions">
                  <button class="primary" id="markConfirmed">Mark Details Confirmed</button>
                </div>
              </aside>
            </main>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script src="chat.js" defer></script>
</body>
</html>

